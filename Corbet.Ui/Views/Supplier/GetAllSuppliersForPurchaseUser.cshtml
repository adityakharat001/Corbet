@model IEnumerable<Corbet.Ui.Models.SupplierViewModel>

@{
    ViewData["Title"] = "GetAllSuppliersForPurchaseUser";
    int counter = 0;
}

    
<aside id="sidebar" class="sidebar">
    <ul class="sidebar-nav" id="sidebar-nav">
        <li class="nav-item">
            <a class="nav-link collapsed" asp-controller="#" asp-action="#">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
            </a>
        </li>
        <!-- End Dashboard Nav -->


        <li class="nav-item">
            <a class="nav-link"
               asp-controller="Supplier"
               asp-action="GetAllSuppliersForPurchaseUser">
                <i class="bi bi-menu-button-wide"></i><span>Suppliers</span>
            </a>
        </li>


        <li class="nav-item">
            <a class="nav-link collapsed"
               asp-controller="PurchaseCart"
               asp-action="PurchaseGetAllCart">
                <i class="bi bi-menu-button-wide"></i><span>Cart</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed"
               asp-controller="PurchaseCart"
               asp-action="GetAllProductPurchase">
                <i class="bi bi-menu-button-wide"></i><span>Products</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed"
               asp-controller="PurchaseCart"
               asp-action="PurchaseAllOrder">
                <i class="bi bi-menu-button-wide"></i><span>Order Status</span>
            </a>
        </li>

    </ul>
</aside>
<!-- End Sidebar -->

<div class="pagetitle">
    <h1>Suppliers</h1>
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">Suppliers</li>
        </ol>
    </nav>
</div>
<p>
    <a class="btn btn-primary" asp-action="AddSupplier">Add New</a>
</p>
<hr />
<table class="table" id="myTable">
    <thead>
        <tr>
            <th>
                Sr. No
            </th>
            <th>
                @Html.DisplayNameFor(model => model.SupplierName)
            </th>
            <th data-orderable="false">
                @Html.DisplayNameFor(model => model.Email)
            </th>
            <th data-orderable="false">
                @Html.DisplayNameFor(model => model.PhoneNumber)
            </th>
            <th data-orderable="false">
                @Html.DisplayNameFor(model => model.DocumentPath)
            </th>
            <th data-orderable="false">Details</th>
            <th data-orderable="false">Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @{
                        counter++;
                    }
                    @counter
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.SupplierName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Email)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.PhoneNumber)
                </td>
                <td>
                    @if (item.DocumentPath != null)
                    {
                        <button class="btn btn-sm btn-dark my-1" data-bs-toggle="modal" data-bs-target="@($"#resumeModal{item.SupplierId}")"><i class="ri-file-text-line"></i></button>
                        <div class="modal fade" id="@($"resumeModal{item.SupplierId}")" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content m-2" style="width: 55vw;">
                                    <div class="modal-header">
                                        <h5 class="modal-title">@item.SupplierName</h5><span>
                                            <button type="button" title="View Document" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </span>
                                    </div>
                                    <iframe id="frame" src="~/Documents/SupplierDocs/@item.DocumentPath" style="height: 80vh;"></iframe>
                                </div>
                            </div>
                        </div>
                    }
                    else

                    {
                        <span>No Document</span>
                    }


                </td>
                <td>
                    <a title="More Details" class="btn btn-sm btn-outline-primary" asp-controller="Supplier" asp-action="GetSupplierDetails" title="View Supplier Details" asp-route-id="@item.SupplierId">View Details</a>
                </td>
                <td class="text-center align-items-center">
                    <a title="Edit" class="btn btn-sm btn-primary my-1" asp-controller="Supplier" asp-action="UpdateSupplierForPurchaseUser" title="Edit Supplier Details" asp-route-id="@item.SupplierId"><i class="ri-edit-box-fill "></i></a>
                    <button title="Delete" class="btn btn-sm btn-danger my-1" onclick="DeleteAlert('@item.SupplierId')" title="Delete Supplier"><i class="ri-delete-bin-6-fill"></i></button>
                </td>
            </tr>
        }
    </tbody>
</table>


<script src="~/lib/jquery/dist/jquery.min.js"></script>

<script>
    $(document).ready(function() {
        $('#myTable').DataTable({

        });
    });

    function DeleteAlert(id) {
        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.assign(`/Supplier/DeleteSupplier/${id}`);
            }
        })
    }

                                            //function ViewDoc(doc) {
                                            //    console.log(doc);
                                            //    Swal.fire({
                                            //        title: 'Supplier document',
                                            //        text: "asdasd",
                                            //        html: `<iframe src="../Documents/SupplierDocs/2b18a51e-8135-43e5-9866-4bea6314bcc6AdityaKharatResume.pdf"></iframe>`,
                                            //        width: "70%",
                                            //    })
                                            //}
</script>