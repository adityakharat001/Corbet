using System;
using System.Collections.Generic;
using System.Security.Cryptography;

using Corbet.Application.Contracts.Persistence;
using Corbet.Application.Features.AddCart.Queries;
using Corbet.Domain.Entities;

using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace Corbet.Persistence.Repositories
{
    public class OrderManagementRepo : BaseRepository<OrderManagement>, IOrderManagementRepo
    {
        public OrderManagementRepo(ApplicationDbContext dbContext, ILogger<OrderManagement> logger) : base(dbContext, logger)
        {

        }

        public async Task<List<GetCartListVm>> GetAllCart(int userId)
        {
           

<<<<<<< HEAD
            var cart= (from c in _dbContext.AddCarts
                         join p in _dbContext.Products
                         on c.ProductId equals p.ProductId
                         join subcategory in _dbContext.ProductSubCategories
                         on p.SubCategoryId equals subcategory.SubCategoryId
                         where (c.UserId == userId)
                         select new GetCartListVm
                         {
                             CartId=c.CartId,
                             image=p.ImagePath,
                             Price = p.Price,
                             ProductName = p.ProductName,
                             Quantity = c.Quantity,
                             Description = subcategory.Description
                         }).ToList();

            return cart;
=======
            var orderingdata = (from o in _dbContext.OrderManagements
                                join p in _dbContext.Products
                                on o.OrderProductId equals p.ProductId
                                join s in _dbContext.Suppliers
                                on o.SupplierId equals s.SupplierId
                                select new GetOrderListVm
                                {
                                    Price = p.Price,
                                    ThumbNail = o.MailThumb,
                                    POThumb = o.MailThumb,
                                    Description = o.Description,
                                    ProductName = p.ProductName,
                                    SupplierName=s.SupplierName,
                                    DeliveryAddress=s.BillingAddress,
                                   CreditLimit=s.CreditPeriod
                                }).ToList();
            return orderingdata;
>>>>>>> 860a3fdaff6b93104a2a8c3d5e0bb70c1f9ed10f
        }

    }
}
